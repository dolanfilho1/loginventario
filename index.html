<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Inventário</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        #appContainer {
            display: none;
            width: 100%;
            height: 100%;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .sidebar {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .nav-link {
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1) !important;
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.2) !important;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .sidebar {
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                z-index: 50;
                height: 100vh;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0,0,0,0.5);
                z-index: 40;
            }
            
            .overlay.active {
                display: block;
            }
        }

        #loginSection {
            width: 100%;
            max-width: 400px;
            padding: 2rem;
        }

        #loginError {
            display: none;
        }

        /* Monetização */
        .ad-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .premium-feature {
            border-left: 4px solid #f59e0b;
            background: rgba(245, 158, 11, 0.1);
            padding: 10px;
            margin: 10px 0;
            position: relative;
        }
        
        .premium-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #f59e0b;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div id="loginSection" class="glass-card rounded-lg shadow-lg">
        <div class="text-center mb-8">
            <h1 class="text-2xl font-bold text-white">InventárioPro</h1>
            <p class="text-white">Acesso Restrito</p>
        </div>
        
        <form id="loginForm" class="space-y-4">
            <div>
                <label for="username" class="block text-sm font-medium text-white mb-1">Usuário</label>
                <input type="text" id="username" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            </div>
            
            <div>
                <label for="password" class="block text-sm font-medium text-white mb-1">Senha</label>
                <input type="password" id="password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            </div>
            
            <div class="pt-2">
                <button type="submit" class="w-full px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <i class="fas fa-sign-in-alt mr-2"></i> Entrar
                </button>
            </div>
        </form>
        
        <div id="loginError" class="mt-4 text-red-300 text-sm">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span>Usuário ou senha incorretos</span>
        </div>

        <!-- Ad space for monetization -->
        <div class="ad-container mt-6">
            <p class="text-sm text-gray-600 mb-2">Patrocinado por:</p>
            <div class="flex justify-center">
                <div class="bg-white p-2 rounded">
                    <p class="text-xs">Anúncio (ex: Google Ads)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (hidden initially) -->
    <div id="appContainer" class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar bg-blue-800 text-white w-64 flex-shrink-0">
            <div class="p-4 flex items-center justify-between border-b border-blue-700">
                <h1 class="text-xl font-bold">InventárioPro</h1>
                <button id="closeSidebar" class="md:hidden text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="p-4">
                <div class="mb-6">
                    <h2 class="text-sm uppercase font-semibold text-blue-300 mb-2">Menu</h2>
                    <ul>
                        <li class="mb-2">
                            <a href="#" id="dashboardLink" class="flex items-center p-2 rounded hover:bg-blue-700 bg-blue-700 nav-link active">
                                <i class="fas fa-tachometer-alt mr-3"></i>
                                Dashboard
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="inventoryLink" class="flex items-center p-2 rounded hover:bg-blue-700 nav-link">
                                <i class="fas fa-boxes mr-3"></i>
                                Inventário
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="addItemLink" class="flex items-center p-2 rounded hover:bg-blue-700 nav-link">
                                <i class="fas fa-plus-circle mr-3"></i>
                                Adicionar Item
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="reportsLink" class="flex items-center p-2 rounded hover:bg-blue-700 nav-link">
                                <i class="fas fa-chart-bar mr-3"></i>
                                Relatórios
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="premiumLink" class="flex items-center p-2 rounded hover:bg-blue-700 nav-link">
                                <i class="fas fa-crown mr-3 text-yellow-400"></i>
                                Premium
                            </a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h2 class="text-sm uppercase font-semibold text-blue-300 mb-2">Exportar</h2>
                    <ul>
                        <li class="mb-2">
                            <a href="#" id="exportExcel" class="flex items-center p-2 rounded hover:bg-blue-700">
                                <i class="fas fa-file-excel mr-3"></i>
                                Para Excel
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="exportWord" class="flex items-center p-2 rounded hover:bg-blue-700">
                                <i class="fas fa-file-word mr-3"></i>
                                Para Word
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" id="exportPdf" class="flex items-center p-2 rounded hover:bg-blue-700">
                                <i class="fas fa-file-pdf mr-3"></i>
                                Para PDF
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Ad space in sidebar -->
                <div class="ad-container mt-6">
                    <p class="text-xs text-white mb-1">Patrocinado:</p>
                    <div class="bg-blue-700 p-1 rounded text-center">
                        <p class="text-xs">Espaço para anúncio</p>
                    </div>
                </div>
            </nav>
        </div>
        
        <!-- Mobile overlay -->
        <div id="overlay" class="overlay"></div>
        
        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top navbar -->
            <header class="bg-white shadow-sm">
                <div class="flex items-center justify-between p-4">
                    <div class="flex items-center">
                        <button id="menuButton" class="md:hidden text-gray-600 mr-4">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <h1 class="text-xl font-semibold text-gray-800" id="pageTitle">Dashboard</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <button class="text-gray-600 hover:text-gray-800">
                                <i class="fas fa-bell text-xl"></i>
                            </button>
                            <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"></span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-semibold" id="userInitial">U</div>
                            <span class="ml-2 text-gray-700 hidden md:inline" id="usernameDisplay">Usuário</span>
                            <button id="logoutButton" class="ml-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm hidden">
                                <i class="fas fa-sign-out-alt mr-2"></i> Sair
                            </button>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main content area -->
            <main class="flex-1 overflow-y-auto p-4 md:p-6">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="fade-in">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        <div class="glass-card rounded-lg shadow-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Total de Itens</p>
                                    <h3 class="text-2xl font-bold" id="totalItems">0</h3>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full">
                                    <i class="fas fa-boxes text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Itens em Estoque</p>
                                    <h3 class="text-2xl font-bold" id="inStockItems">0</h3>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full">
                                    <i class="fas fa-check-circle text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Itens com Baixo Estoque</p>
                                    <h3 class="text-2xl font-bold" id="lowStockItems">0</h3>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded-full">
                                    <i class="fas fa-exclamation-triangle text-yellow-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Itens Esgotados</p>
                                    <h3 class="text-2xl font-bold" id="outOfStockItems">0</h3>
                                </div>
                                <div class="bg-red-100 p-3 rounded-full">
                                    <i class="fas fa-times-circle text-red-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ad space -->
                    <div class="ad-container">
                        <p class="text-sm text-center text-gray-600 mb-2">Patrocinado:</p>
                        <div class="bg-gray-100 p-3 rounded text-center">
                            <p>Espaço para anúncio ou promoção premium</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6 mb-6">
                        <h2 class="text-lg font-semibold mb-4">Atividade Recente</h2>
                        <div class="overflow-x-auto">
                            <div class="flex justify-between items-center mb-4">
                                <h2 class="text-lg font-semibold">Atividade Recente</h2>
                                <button id="clearActivityBtn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm">
                                    <i class="fas fa-trash-alt mr-2"></i> Limpar Atividade
                                </button>
                            </div>
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Item</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ação</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantidade</th>
                                    </tr>
                                </thead>
                                <tbody id="recentActivity" class="bg-white divide-y divide-gray-200">
                                    <!-- Recent activity will be added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h2 class="text-lg font-semibold mb-4">Categorias de Itens</h2>
                            <canvas id="categoryChart" class="h-64"></canvas>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <h2 class="text-lg font-semibold mb-4">Status de Estoque</h2>
                            <canvas id="statusChart" class="h-64"></canvas>
                        </div>
                    </div>
                </section>
                
                <!-- Inventory Section -->
                <section id="inventorySection" class="fade-in hidden">
                    <div class="bg-white rounded-lg shadow p-6 mb-6">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                            <h2 class="text-lg font-semibold mb-4 md:mb-0">Todos os Itens</h2>
                            <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                                <div class="relative">
                                    <input type="text" id="inventorySearch" placeholder="Pesquisar..." class="pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                                </div>
                                <select id="categoryFilter" class="border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Todas Categorias</option>
                                    <!-- Categories will be added here -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Código</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantidade</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="inventoryTable" class="bg-white divide-y divide-gray-200">
                                    <!-- Inventory items will be added here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="flex items-center justify-between mt-4">
                            <div class="text-sm text-gray-500">
                                Mostrando <span id="startItem">1</span> a <span id="endItem">10</span> de <span id="totalInventoryItems">0</span> itens
                            </div>
                            <div class="flex space-x-2">
                                <button id="prevPage" class="px-4 py-2 border rounded-lg bg-gray-100 text-gray-700 disabled:opacity-50" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button id="nextPage" class="px-4 py-2 border rounded-lg bg-gray-100 text-gray-700 disabled:opacity-50" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Premium upsell -->
                    <div class="premium-feature">
                        <div class="premium-badge">PREMIUM</div>
                        <h3 class="font-semibold text-yellow-700">Recursos Avançados</h3>
                        <p class="text-sm text-gray-700">Atualize para a versão Premium para desbloquear relatórios avançados, histórico completo e suporte prioritário.</p>
                        <button class="mt-2 px-4 py-1 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600">
                            Saiba Mais
                        </button>
                    </div>
                </section>
                
                <!-- Add Item Section -->
                <section id="addItemSection" class="fade-in hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-lg font-semibold mb-6">Adicionar Novo Item</h2>
                        
                        <form id="addItemForm" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="itemCode" class="block text-sm font-medium text-gray-700 mb-1">Código do Item*</label>
                                    <input type="text" id="itemCode" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label for="itemName" class="block text-sm font-medium text-gray-700 mb-1">Nome do Item*</label>
                                    <input type="text" id="itemName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="itemCategory" class="block text-sm font-medium text-gray-700 mb-1">Categoria*</label>
                                    <select id="itemCategory" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                        <option value="">Selecione uma categoria</option>
                                        <option value="Sonorização">Sonorização</option>
                                        <option value="Iluminação">Iluminação</option>
                                        <option value="Painel LED">Painel LED</option>
                                        <option value="Microfones">Microfones</option>
                                        <option value="Mixers">Mixers</option>
                                        <option value="Cabos e Conectores">Cabos e Conectores</option>
                                        <option value="Truss e Estruturas">Truss e Estruturas</option>
                                        <option value="Outros">Outros</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="itemQuantity" class="block text-sm font-medium text-gray-700 mb-1">Quantidade*</label>
                                    <input type="number" id="itemQuantity" min="0" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="itemLocation" class="block text-sm font-medium text-gray-700 mb-1">Localização</label>
                                    <input type="text" id="itemLocation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label for="itemThreshold" class="block text-sm font-medium text-gray-700 mb-1">Limite de Estoque Baixo</label>
                                    <input type="number" id="itemThreshold" min="0" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div>
                                <label for="itemDescription" class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                                <textarea id="itemDescription" rows="3" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                            
                            <div class="flex justify-end space-x-3 pt-4">
                                <button type="reset" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    Limpar
                                </button>
                                <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <i class="fas fa-save mr-2"></i> Salvar Item
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Reports Section -->
                <section id="reportsSection" class="fade-in hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-lg font-semibold mb-6">Relatórios</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                            <div class="border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" id="stockReport">
                                <div class="flex items-center">
                                    <div class="bg-blue-100 p-3 rounded-full mr-4">
                                        <i class="fas fa-boxes text-blue-600 text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-medium">Relatório de Estoque</h3>
                                        <p class="text-sm text-gray-500">Visão geral do estoque atual</p>
                                    </div>
                                </div>
                            </div>
                            <div class="border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" id="lowStockReport">
                                <div class="flex items-center">
                                    <div class="bg-yellow-100 p-3 rounded-full mr-4">
                                        <i class="fas fa-exclamation-triangle text-yellow-600 text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-medium">Itens com Baixo Estoque</h3>
                                        <p class="text-sm text-gray-500">Itens que precisam ser reabastecidos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" id="categoryReport">
                                <div class="flex items-center">
                                    <div class="bg-green-100 p-3 rounded-full mr-4">
                                        <i class="fas fa-tags text-green-600 text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-medium">Relatório por Categoria</h3>
                                        <p class="text-sm text-gray-500">Distribuição por categorias</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="font-medium mb-4">Exportar Relatório</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Relatório</label>
                                    <select id="reportType" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="stock">Relatório de Estoque</option>
                                        <option value="lowStock">Itens com Baixo Estoque</option>
                                        <option value="category">Relatório por Categoria</option>
                                        <option value="all">Relatório Completo</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Formato</label>
                                    <select id="exportFormat" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="excel">Excel (.xlsx)</option>
                                        <option value="word">Word (.docx)</option>
                                        <option value="pdf">PDF (.pdf)</option>
                                    </select>
                                </div>
                                <div class="flex items-end">
                                    <button id="generateReport" class="w-full px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        Gerar Relatório
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Premium upsell -->
                    <div class="premium-feature mt-6">
                        <div class="premium-badge">PREMIUM</div>
                        <h3 class="font-semibold text-yellow-700">Relatórios Avançados</h3>
                        <p class="text-sm text-gray-700">Obtenha relatórios detalhados com análise de tendências, previsões de estoque e exportação em mais formatos com a versão Premium.</p>
                        <button class="mt-2 px-4 py-1 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600">
                            Atualizar Agora
                        </button>
                    </div>
                </section>

                <!-- Premium Section -->
                <section id="premiumSection" class="fade-in hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="text-center mb-8">
                            <div class="inline-block bg-yellow-100 p-3 rounded-full mb-4">
                                <i class="fas fa-crown text-yellow-600 text-3xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-yellow-700">InventárioPro Premium</h2>
                            <p class="text-gray-600">Desbloqueie todo o potencial do seu sistema de inventário</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="border rounded-lg p-6 text-center">
                                <h3 class="text-lg font-semibold mb-2">Básico</h3>
                                <p class="text-3xl font-bold mb-4">Grátis</p>
                                <ul class="text-left space-y-2 mb-6">
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Gestão básica de estoque</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Relatórios simples</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Exportação em Excel</li>
                                    <li class="flex items-center"><i class="fas fa-times text-red-500 mr-2"></i> Histórico completo</li>
                                    <li class="flex items-center"><i class="fas fa-times text-red-500 mr-2"></i> Suporte prioritário</li>
                                </ul>
                                <button class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg w-full">Seu Plano Atual</button>
                            </div>
                            
                            <div class="border-2 border-yellow-500 rounded-lg p-6 text-center transform scale-105 relative">
                                <div class="absolute top-0 right-0 bg-yellow-500 text-white px-3 py-1 text-xs font-bold rounded-bl-lg">RECOMENDADO</div>
                                <h3 class="text-lg font-semibold mb-2">Profissional</h3>
                                <p class="text-3xl font-bold mb-4">R$ 49,90<span class="text-sm font-normal">/mês</span></p>
                                <ul class="text-left space-y-2 mb-6">
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Tudo no Básico</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Relatórios avançados</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Exportação em PDF/Word</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Histórico de 6 meses</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Suporte por email</li>
                                </ul>
                                <button class="px-6 py-2 bg-yellow-500 text-white rounded-lg w-full hover:bg-yellow-600">Assinar Agora</button>
                            </div>
                            
                            <div class="border rounded-lg p-6 text-center">
                                <h3 class="text-lg font-semibold mb-2">Empresarial</h3>
                                <p class="text-3xl font-bold mb-4">R$ 99,90<span class="text-sm font-normal">/mês</span></p>
                                <ul class="text-left space-y-2 mb-6">
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Tudo no Profissional</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Usuários ilimitados</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Histórico completo</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Integração com ERP</li>
                                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Suporte 24/7</li>
                                </ul>
                                <button class="px-6 py-2 bg-blue-600 text-white rounded-lg w-full hover:bg-blue-700">Assinar Agora</button>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold mb-4 text-yellow-700">Perguntas Frequentes</h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-medium">Posso cancelar a qualquer momento?</h4>
                                    <p class="text-sm text-gray-600">Sim, você pode cancelar sua assinatura Premium a qualquer momento sem taxas adicionais.</p>
                                </div>
                                <div>
                                    <h4 class="font-medium">Há um período de teste gratuito?</h4>
                                    <p class="text-sm text-gray-600">Oferecemos 7 dias grátis para testar todos os recursos Premium.</p>
                                </div>
                                <div>
                                    <h4 class="font-medium">Quais métodos de pagamento são aceitos?</h4>
                                    <p class="text-sm text-gray-600">Aceitamos cartões de crédito, débito e pagamentos via PIX.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <!-- Edit Item Modal -->
    <div id="editModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="absolute inset-0 bg-black opacity-50"></div>
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4 z-50">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Editar Item</h3>
                    <button id="closeEditModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="editItemForm" class="space-y-4">
                    <input type="hidden" id="editItemId">
                    <div>
                        <label for="editItemCode" class="block text-sm font-medium text-gray-700 mb-1">Código do Item*</label>
                        <input type="text" id="editItemCode" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="editItemName" class="block text-sm font-medium text-gray-700 mb-1">Nome do Item*</label>
                        <input type="text" id="editItemName" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="editItemCategory" class="block text-sm font-medium text-gray-700 mb-1">Categoria*</label>
                        <select id="editItemCategory" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="Sonorização">Sonorização</option>
                            <option value="Iluminação">Iluminação</option>
                            <option value="Painel LED">Painel LED</option>
                            <option value="Microfones">Microfones</option>
                            <option value="Mixers">Mixers</option>
                            <option value="Cabos e Conectores">Cabos e Conectores</option>
                            <option value="Truss e Estruturas">Truss e Estruturas</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div>
                        <label for="editItemQuantity" class="block text-sm font-medium text-gray-700 mb-1">Quantidade*</label>
                        <input type="number" id="editItemQuantity" min="0" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="editItemLocation" class="block text-sm font-medium text-gray-700 mb-1">Localização</label>
                        <input type="text" id="editItemLocation" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="editItemThreshold" class="block text-sm font-medium text-gray-700 mb-1">Limite de Estoque Baixo</label>
                        <input type="number" id="editItemThreshold" min="0" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="editItemDescription" class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                        <textarea id="editItemDescription" rows="3" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>
                    
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" id="cancelEdit" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            Cancelar
                        </button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <i class="fas fa-save mr-2"></i> Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="absolute inset-0 bg-black opacity-50"></div>
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4 z-50">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Confirmar Exclusão</h3>
                    <button id="closeDeleteModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <p class="mb-6">Tem certeza que deseja excluir este item? Esta ação não pode ser desfeita.</p>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancelDelete" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Cancelar
                    </button>
                    <button type="button" id="confirmDelete" class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
                        <i class="fas fa-trash-alt mr-2"></i> Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- View Item Modal -->
    <div id="viewModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="absolute inset-0 bg-black opacity-50"></div>
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4 z-50">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Detalhes do Item</h3>
                    <button id="closeViewModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Código do Item</h4>
                        <p id="viewItemCode" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Nome do Item</h4>
                        <p id="viewItemName" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Categoria</h4>
                        <p id="viewItemCategory" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Quantidade</h4>
                        <p id="viewItemQuantity" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Status</h4>
                        <p id="viewItemStatus" class="mt-1">
                            <span id="statusBadge" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"></span>
                        </p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Localização</h4>
                        <p id="viewItemLocation" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Limite de Estoque Baixo</h4>
                        <p id="viewItemThreshold" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Descrição</h4>
                        <p id="viewItemDescription" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Data de Criação</h4>
                        <p id="viewItemCreatedAt" class="mt-1 text-gray-900"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Última Atualização</h4>
                        <p id="viewItemUpdatedAt" class="mt-1 text-gray-900"></p>
                    </div>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button type="button" id="closeViewModalBtn" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Lista de usuários autorizados (usuário: senha)
        const authorizedUsers = {
            "admin": "admin123",
            "gerente": "gerente456",
            "estoque": "estoque789",
            "operador1": "op123456",
            "operador2": "op654321"
        };

        // Variáveis para os gráficos
        let categoryChartInstance = null;
        let statusChartInstance = null;

        // Verifica se o usuário já está logado
        if (localStorage.getItem('isLoggedIn') === 'true') {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            initializeInventorySystem();
            setupLogoutButton();
            showCurrentUser();
        }

        // Formulário de login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Verifica as credenciais
            if (authorizedUsers[username] && authorizedUsers[username] === password) {
                // Login bem-sucedido
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('currentUser', username);
                
                document.getElementById('loginError').style.display = 'none';
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('appContainer').style.display = 'flex';
                
                initializeInventorySystem();
                setupLogoutButton();
                showCurrentUser();
            } else {
                // Login falhou
                document.getElementById('loginError').style.display = 'block';
            }
        });

        function showCurrentUser() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                document.getElementById('userInitial').textContent = currentUser.charAt(0).toUpperCase();
                document.getElementById('usernameDisplay').textContent = currentUser;
            }
        }

        function setupLogoutButton() {
            const logoutButton = document.getElementById('logoutButton');
            logoutButton.classList.remove('hidden');
            logoutButton.addEventListener('click', function() {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('currentUser');
                location.reload();
            });
        }

        // Função para inicializar o sistema de inventário
        function initializeInventorySystem() {
            // Sample data for demonstration
            if (!localStorage.getItem('inventoryItems')) {
                const sampleItems = [
                    {
                        id: '1',
                        code: 'SONO-001',
                        name: 'Caixa de Som JBL EON715',
                        category: 'Sonorização',
                        quantity: 8,
                        threshold: 2,
                        location: 'Depósito A',
                        description: 'Caixa de som ativa 15" 1300W RMS',
                        status: 'in-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '2',
                        code: 'LED-001',
                        name: 'Painel LED P3.91',
                        category: 'Painel LED',
                        quantity: 20,
                        threshold: 5,
                        location: 'Depósito B',
                        description: 'Painel LED 500x500mm resolução P3.91',
                        status: 'in-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '3',
                        code: 'ILUM-001',
                        name: 'Moving Head 300W',
                        category: 'Iluminação',
                        quantity: 4,
                        threshold: 1,
                        location: 'Depósito C',
                        description: 'Moving Head Spot 300W RGBW',
                        status: 'low-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '4',
                        code: 'MIC-001',
                        name: 'Microfone Sem Fio Shure BLX288',
                        category: 'Microfones',
                        quantity: 6,
                        threshold: 2,
                        location: 'Depósito A',
                        description: 'Microfone sem fio com receptor dual',
                        status: 'in-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '5',
                        code: 'MIX-001',
                        name: 'Mixer Digital Yamaha MG12XU',
                        category: 'Mixers',
                        quantity: 2,
                        threshold: 1,
                        location: 'Depósito B',
                        description: 'Mixer analógico 12 canais com USB',
                        status: 'low-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '6',
                        code: 'CAB-001',
                        name: 'Cabo XLR 5m',
                        category: 'Cabos e Conectores',
                        quantity: 0,
                        threshold: 10,
                        location: 'Depósito C',
                        description: 'Cabo balanceado XLR 5 metros',
                        status: 'out-of-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: '7',
                        code: 'TRUSS-001',
                        name: 'Truss Alumínio 1m',
                        category: 'Truss e Estruturas',
                        quantity: 15,
                        threshold: 5,
                        location: 'Depósito Externo',
                        description: 'Truss de alumínio 1 metro quadrado',
                        status: 'in-stock',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem('inventoryItems', JSON.stringify(sampleItems));
                
                // Add some recent activity
                const recentActivity = [
                    {
                        date: new Date().toISOString(),
                        item: 'Caixa de Som JBL EON715',
                        action: 'Adicionado',
                        quantity: 8
                    },
                    {
                        date: new Date(Date.now() - 86400000).toISOString(),
                        item: 'Painel LED P3.91',
                        action: 'Adicionado',
                        quantity: 20
                    },
                    {
                        date: new Date(Date.now() - 172800000).toISOString(),
                        item: 'Moving Head 300W',
                        action: 'Adicionado',
                        quantity: 4
                    },
                    {
                        date: new Date(Date.now() - 259200000).toISOString(),
                        item: 'Cabo XLR 5m',
                        action: 'Adicionado',
                        quantity: 10
                    },
                    {
                        date: new Date(Date.now() - 345600000).toISOString(),
                        item: 'Cabo XLR 5m',
                        action: 'Consumido',
                        quantity: -10
                    }
                ];
                localStorage.setItem('recentActivity', JSON.stringify(recentActivity));
            }
            
            // Initialize the UI
            initUI();
            
            // Load dashboard data
            loadDashboardData();
            
            // Load inventory data
            loadInventoryData();
            
            // Setup event listeners
            setupEventListeners();
        }

        function initUI() {
            // Mobile menu toggle
            const menuButton = document.getElementById('menuButton');
            const closeSidebar = document.getElementById('closeSidebar');
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('overlay');
            
            menuButton.addEventListener('click', function() {
                sidebar.classList.add('active');
                overlay.classList.add('active');
            });
            
            closeSidebar.addEventListener('click', function() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            });
            
            overlay.addEventListener('click', function() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            });
            
            // Navigation links
            const navLinks = {
                dashboardLink: 'dashboardSection',
                inventoryLink: 'inventorySection',
                addItemLink: 'addItemSection',
                reportsLink: 'reportsSection',
                premiumLink: 'premiumSection'
            };
            
            Object.keys(navLinks).forEach(linkId => {
                document.getElementById(linkId).addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Hide all sections
                    document.querySelectorAll('main > section').forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    // Show selected section
                    const sectionId = navLinks[linkId];
                    document.getElementById(sectionId).classList.remove('hidden');
                    
                    // Update page title
                    const pageTitle = document.getElementById('pageTitle');
                    pageTitle.textContent = document.getElementById(linkId).textContent.trim();
                    
                    // Update active nav link
                    document.querySelectorAll('nav a').forEach(navLink => {
                        navLink.classList.remove('bg-blue-700');
                    });
                    this.classList.add('bg-blue-700');
                    
                    // Close mobile menu if open
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                    
                    // Load data for the section if needed
                    if (sectionId === 'dashboardSection') {
                        loadDashboardData();
                    } else if (sectionId === 'inventorySection') {
                        loadInventoryData();
                    }
                });
            });
            
            // Populate category filter dropdown
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const categories = [...new Set(items.map(item => item.category))];
            const categoryFilter = document.getElementById('categoryFilter');
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
            
            // Clear activity button
            document.getElementById('clearActivityBtn').addEventListener('click', function() {
                if (confirm('Tem certeza que deseja limpar todo o histórico de atividade?')) {
                    localStorage.removeItem('recentActivity');
                    loadDashboardData();
                }
            });
        }
        
        function loadDashboardData() {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const recentActivity = JSON.parse(localStorage.getItem('recentActivity')) || [];
            
            // Calculate stats
            const totalItems = items.length;
            const inStockItems = items.filter(item => item.status === 'in-stock').length;
            const lowStockItems = items.filter(item => item.status === 'low-stock').length;
            const outOfStockItems = items.filter(item => item.status === 'out-of-stock').length;
            
            // Update dashboard stats
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('inStockItems').textContent = inStockItems;
            document.getElementById('lowStockItems').textContent = lowStockItems;
            document.getElementById('outOfStockItems').textContent = outOfStockItems;
            
            // Update recent activity
            const recentActivityTable = document.getElementById('recentActivity');
            recentActivityTable.innerHTML = '';
            
            recentActivity.slice(0, 5).forEach(activity => {
                const row = document.createElement('tr');
                
                const dateCell = document.createElement('td');
                dateCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                dateCell.textContent = new Date(activity.date).toLocaleDateString();
                
                const itemCell = document.createElement('td');
                itemCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
                itemCell.textContent = activity.item;
                
                const actionCell = document.createElement('td');
                actionCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                actionCell.textContent = activity.action;
                
                const quantityCell = document.createElement('td');
                quantityCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                quantityCell.textContent = activity.quantity > 0 ? `+${activity.quantity}` : activity.quantity;
                
                row.appendChild(dateCell);
                row.appendChild(itemCell);
                row.appendChild(actionCell);
                row.appendChild(quantityCell);
                
                recentActivityTable.appendChild(row);
            });
            
            // Update category chart
            updateCategoryChart(items);
            
            // Update status chart
            updateStatusChart(items);
        }
        
        function updateCategoryChart(items) {
            const categories = [...new Set(items.map(item => item.category))];
            const categoryCounts = categories.map(category => 
                items.filter(item => item.category === category).length
            );
            
            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            // Destroy previous chart instance if exists
            if (categoryChartInstance) {
                categoryChartInstance.destroy();
            }
            
            categoryChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [{
                        label: 'Itens por Categoria',
                        data: categoryCounts,
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(153, 102, 255, 0.7)',
                            'rgba(255, 205, 86, 0.7)',
                            'rgba(201, 203, 207, 0.7)'
                        ],
                        borderColor: [
                            'rgb(54, 162, 235)',
                            'rgb(255, 99, 132)',
                            'rgb(75, 192, 192)',
                            'rgb(255, 159, 64)',
                            'rgb(153, 102, 255)',
                            'rgb(255, 205, 86)',
                            'rgb(201, 203, 207)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateStatusChart(items) {
            const statusCounts = {
                'Em Estoque': items.filter(item => item.status === 'in-stock').length,
                'Estoque Baixo': items.filter(item => item.status === 'low-stock').length,
                'Esgotado': items.filter(item => item.status === 'out-of-stock').length
            };
            
            const ctx = document.getElementById('statusChart').getContext('2d');
            
            // Destroy previous chart instance if exists
            if (statusChartInstance) {
                statusChartInstance.destroy();
            }
            
            statusChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        label: 'Status de Estoque',
                        data: Object.values(statusCounts),
                        backgroundColor: [
                            'rgba(75, 192, 75, 0.7)',
                            'rgba(255, 205, 86, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgb(75, 192, 75)',
                            'rgb(255, 205, 86)',
                            'rgb(255, 99, 132)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function loadInventoryData(page = 1, searchTerm = '', categoryFilter = '') {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const itemsPerPage = 10;
            
            // Filter items based on search term and category
            let filteredItems = items.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                      item.code.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesCategory = categoryFilter === '' || item.category === categoryFilter;
                return matchesSearch && matchesCategory;
            });
            
            // Pagination
            const totalItems = filteredItems.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, totalItems);
            const paginatedItems = filteredItems.slice(startIndex, endIndex);
            
            // Update inventory table
            const inventoryTable = document.getElementById('inventoryTable');
            inventoryTable.innerHTML = '';
            
            if (paginatedItems.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center';
                cell.colSpan = 6;
                cell.textContent = 'Nenhum item encontrado';
                row.appendChild(cell);
                inventoryTable.appendChild(row);
            } else {
                paginatedItems.forEach(item => {
                    const row = document.createElement('tr');
                    
                    // Code
                    const codeCell = document.createElement('td');
                    codeCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
                    codeCell.textContent = item.code;
                    
                    // Name
                    const nameCell = document.createElement('td');
                    nameCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                    nameCell.textContent = item.name;
                    
                    // Category
                    const categoryCell = document.createElement('td');
                    categoryCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                    categoryCell.textContent = item.category;
                    
                    // Quantity
                    const quantityCell = document.createElement('td');
                    quantityCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
                    quantityCell.textContent = item.quantity;
                    
                    // Status
                    const statusCell = document.createElement('td');
                    statusCell.className = 'px-6 py-4 whitespace-nowrap text-sm';
                    
                    const statusBadge = document.createElement('span');
                    statusBadge.className = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium';
                    
                    if (item.status === 'in-stock') {
                        statusBadge.className += ' bg-green-100 text-green-800';
                        statusBadge.textContent = 'Em Estoque';
                    } else if (item.status === 'low-stock') {
                        statusBadge.className += ' bg-yellow-100 text-yellow-800';
                        statusBadge.textContent = 'Estoque Baixo';
                    } else {
                        statusBadge.className += ' bg-red-100 text-red-800';
                        statusBadge.textContent = 'Esgotado';
                    }
                    
                    statusCell.appendChild(statusBadge);
                    
                    // Actions
                    const actionsCell = document.createElement('td');
                    actionsCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium';
                    
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'flex space-x-2';
                    
                    // View button
                    const viewButton = document.createElement('button');
                    viewButton.className = 'text-blue-600 hover:text-blue-900';
                    viewButton.innerHTML = '<i class="fas fa-eye"></i>';
                    viewButton.addEventListener('click', () => openViewModal(item.id));
                    
                    // Edit button
                    const editButton = document.createElement('button');
                    editButton.className = 'text-yellow-600 hover:text-yellow-900';
                    editButton.innerHTML = '<i class="fas fa-edit"></i>';
                    editButton.addEventListener('click', () => openEditModal(item.id));
                    
                    // Delete button
                    const deleteButton = document.createElement('button');
                    deleteButton.className = 'text-red-600 hover:text-red-900';
                    deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
                    deleteButton.addEventListener('click', () => openDeleteModal(item.id));
                    
                    actionsDiv.appendChild(viewButton);
                    actionsDiv.appendChild(editButton);
                    actionsDiv.appendChild(deleteButton);
                    actionsCell.appendChild(actionsDiv);
                    
                    row.appendChild(codeCell);
                    row.appendChild(nameCell);
                    row.appendChild(categoryCell);
                    row.appendChild(quantityCell);
                    row.appendChild(statusCell);
                    row.appendChild(actionsCell);
                    
                    inventoryTable.appendChild(row);
                });
            }
            
            // Update pagination info
            document.getElementById('startItem').textContent = totalItems === 0 ? 0 : startIndex + 1;
            document.getElementById('endItem').textContent = endIndex;
            document.getElementById('totalInventoryItems').textContent = totalItems;
            
            // Update pagination buttons
            const prevButton = document.getElementById('prevPage');
            const nextButton = document.getElementById('nextPage');
            
            prevButton.disabled = page <= 1;
            nextButton.disabled = page >= totalPages;
            
            prevButton.onclick = () => loadInventoryData(page - 1, searchTerm, categoryFilter);
            nextButton.onclick = () => loadInventoryData(page + 1, searchTerm, categoryFilter);
        }
        
        function setupEventListeners() {
            // Add item form
            const addItemForm = document.getElementById('addItemForm');
            addItemForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const code = document.getElementById('itemCode').value;
                const name = document.getElementById('itemName').value;
                const category = document.getElementById('itemCategory').value;
                const quantity = parseInt(document.getElementById('itemQuantity').value);
                const location = document.getElementById('itemLocation').value;
                const threshold = parseInt(document.getElementById('itemThreshold').value) || 0;
                const description = document.getElementById('itemDescription').value;
                
                // Determine status based on quantity and threshold
                let status;
                if (quantity === 0) {
                    status = 'out-of-stock';
                } else if (threshold > 0 && quantity <= threshold) {
                    status = 'low-stock';
                } else {
                    status = 'in-stock';
                }
                
                // Create new item
                const newItem = {
                    id: Date.now().toString(),
                    code,
                    name,
                    category,
                    quantity,
                    threshold,
                    location,
                    description,
                    status,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                // Save to local storage
                const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
                items.push(newItem);
                localStorage.setItem('inventoryItems', JSON.stringify(items));
                
                // Add to recent activity
                const recentActivity = JSON.parse(localStorage.getItem('recentActivity')) || [];
                recentActivity.unshift({
                    date: new Date().toISOString(),
                    item: name,
                    action: 'Adicionado',
                    quantity: quantity
                });
                localStorage.setItem('recentActivity', JSON.stringify(recentActivity));
                
                // Reset form
                addItemForm.reset();
                
                // Show success message
                alert('Item adicionado com sucesso!');
                
                // Reload inventory data
                loadInventoryData();
                
                // Update dashboard
                loadDashboardData();
            });
            
            // Inventory search
            const inventorySearch = document.getElementById('inventorySearch');
            inventorySearch.addEventListener('input', function() {
                const categoryFilter = document.getElementById('categoryFilter').value;
                loadInventoryData(1, this.value, categoryFilter);
            });
            
            // Category filter
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.addEventListener('change', function() {
                const searchTerm = document.getElementById('inventorySearch').value;
                loadInventoryData(1, searchTerm, this.value);
            });
            
            // Export to Excel
            document.getElementById('exportExcel').addEventListener('click', function(e) {
                e.preventDefault();
                exportToExcel('all');
            });
            
            // Export to Word
            document.getElementById('exportWord').addEventListener('click', function(e) {
                e.preventDefault();
                exportToWord('all');
            });
            
            // Export to PDF
            document.getElementById('exportPdf').addEventListener('click', function(e) {
                e.preventDefault();
                exportToPdf('all');
            });
            
            // Report buttons
            document.getElementById('stockReport').addEventListener('click', function() {
                document.getElementById('reportType').value = 'stock';
                document.getElementById('exportFormat').value = 'excel';
            });
            
            document.getElementById('lowStockReport').addEventListener('click', function() {
                document.getElementById('reportType').value = 'lowStock';
                document.getElementById('exportFormat').value = 'excel';
            });
            
            document.getElementById('categoryReport').addEventListener('click', function() {
                document.getElementById('reportType').value = 'category';
                document.getElementById('exportFormat').value = 'excel';
            });
            
            // Generate report button
            document.getElementById('generateReport').addEventListener('click', function() {
                const reportType = document.getElementById('reportType').value;
                const exportFormat = document.getElementById('exportFormat').value;
                
                if (exportFormat === 'excel') {
                    exportToExcel(reportType);
                } else if (exportFormat === 'word') {
                    exportToWord(reportType);
                } else if (exportFormat === 'pdf') {
                    exportToPdf(reportType);
                }
            });
        }
        
        function openViewModal(itemId) {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const item = items.find(i => i.id === itemId);
            
            if (!item) return;
            
            // Populate view modal
            document.getElementById('viewItemCode').textContent = item.code;
            document.getElementById('viewItemName').textContent = item.name;
            document.getElementById('viewItemCategory').textContent = item.category;
            document.getElementById('viewItemQuantity').textContent = item.quantity;
            document.getElementById('viewItemLocation').textContent = item.location || 'N/A';
            document.getElementById('viewItemThreshold').textContent = item.threshold || 'N/A';
            document.getElementById('viewItemDescription').textContent = item.description || 'N/A';
            document.getElementById('viewItemCreatedAt').textContent = new Date(item.createdAt).toLocaleString();
            document.getElementById('viewItemUpdatedAt').textContent = new Date(item.updatedAt).toLocaleString();
            
            // Set status badge
            const statusBadge = document.getElementById('statusBadge');
            statusBadge.className = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium';
            
            if (item.status === 'in-stock') {
                statusBadge.className += ' bg-green-100 text-green-800';
                statusBadge.textContent = 'Em Estoque';
            } else if (item.status === 'low-stock') {
                statusBadge.className += ' bg-yellow-100 text-yellow-800';
                statusBadge.textContent = 'Estoque Baixo';
            } else {
                statusBadge.className += ' bg-red-100 text-red-800';
                statusBadge.textContent = 'Esgotado';
            }
            
            // Show modal
            document.getElementById('viewModal').classList.remove('hidden');
            
            // Close modal button
            document.getElementById('closeViewModalBtn').addEventListener('click', function() {
                document.getElementById('viewModal').classList.add('hidden');
            });
            
            // Close modal when clicking X
            document.getElementById('closeViewModal').addEventListener('click', function() {
                document.getElementById('viewModal').classList.add('hidden');
            });
        }
        
        function openEditModal(itemId) {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const item = items.find(i => i.id === itemId);
            
            if (!item) return;
            
            // Populate edit form
            document.getElementById('editItemId').value = item.id;
            document.getElementById('editItemCode').value = item.code;
            document.getElementById('editItemName').value = item.name;
            document.getElementById('editItemCategory').value = item.category;
            document.getElementById('editItemQuantity').value = item.quantity;
            document.getElementById('editItemLocation').value = item.location || '';
            document.getElementById('editItemThreshold').value = item.threshold || '';
            document.getElementById('editItemDescription').value = item.description || '';
            
            // Show modal
            document.getElementById('editModal').classList.remove('hidden');
            
            // Edit form submission
            const editItemForm = document.getElementById('editItemForm');
            editItemForm.onsubmit = function(e) {
                e.preventDefault();
                
                const updatedItem = {
                    id: item.id,
                    code: document.getElementById('editItemCode').value,
                    name: document.getElementById('editItemName').value,
                    category: document.getElementById('editItemCategory').value,
                    quantity: parseInt(document.getElementById('editItemQuantity').value),
                    threshold: parseInt(document.getElementById('editItemThreshold').value) || 0,
                    location: document.getElementById('editItemLocation').value,
                    description: document.getElementById('editItemDescription').value,
                    createdAt: item.createdAt,
                    updatedAt: new Date().toISOString()
                };
                
                // Determine status based on quantity and threshold
                if (updatedItem.quantity === 0) {
                    updatedItem.status = 'out-of-stock';
                } else if (updatedItem.threshold > 0 && updatedItem.quantity <= updatedItem.threshold) {
                    updatedItem.status = 'low-stock';
                } else {
                    updatedItem.status = 'in-stock';
                }
                
                // Update item in local storage
                const updatedItems = items.map(i => i.id === item.id ? updatedItem : i);
                localStorage.setItem('inventoryItems', JSON.stringify(updatedItems));
                
                // Add to recent activity if quantity changed
                if (item.quantity !== updatedItem.quantity) {
                    const recentActivity = JSON.parse(localStorage.getItem('recentActivity')) || [];
                    recentActivity.unshift({
                        date: new Date().toISOString(),
                        item: updatedItem.name,
                        action: 'Atualizado',
                        quantity: updatedItem.quantity - item.quantity
                    });
                    localStorage.setItem('recentActivity', JSON.stringify(recentActivity));
                }
                
                // Close modal
                document.getElementById('editModal').classList.add('hidden');
                
                // Show success message
                alert('Item atualizado com sucesso!');
                
                // Reload inventory data
                loadInventoryData();
                
                // Update dashboard
                loadDashboardData();
            };
            
            // Cancel button
            document.getElementById('cancelEdit').addEventListener('click', function() {
                document.getElementById('editModal').classList.add('hidden');
            });
            
            // Close modal when clicking X
            document.getElementById('closeEditModal').addEventListener('click', function() {
                document.getElementById('editModal').classList.add('hidden');
            });
        }
        
        function openDeleteModal(itemId) {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            const item = items.find(i => i.id === itemId);
            
            if (!item) return;
            
            // Store item ID for deletion
            document.getElementById('confirmDelete').dataset.itemId = item.id;
            
            // Show modal
            document.getElementById('deleteModal').classList.remove('hidden');
            
            // Confirm delete button
            document.getElementById('confirmDelete').addEventListener('click', function() {
                const itemId = this.dataset.itemId;
                
                // Remove item from local storage
                const updatedItems = items.filter(i => i.id !== itemId);
                localStorage.setItem('inventoryItems', JSON.stringify(updatedItems));
                
                // Add to recent activity
                const recentActivity = JSON.parse(localStorage.getItem('recentActivity')) || [];
                recentActivity.unshift({
                    date: new Date().toISOString(),
                    item: item.name,
                    action: 'Removido',
                    quantity: -item.quantity
                });
                localStorage.setItem('recentActivity', JSON.stringify(recentActivity));
                
                // Close modal
                document.getElementById('deleteModal').classList.add('hidden');
                
                // Show success message
                alert('Item removido com sucesso!');
                
                // Reload inventory data
                loadInventoryData();
                
                // Update dashboard
                loadDashboardData();
            });
            
            // Cancel button
            document.getElementById('cancelDelete').addEventListener('click', function() {
                document.getElementById('deleteModal').classList.add('hidden');
            });
            
            // Close modal when clicking X
            document.getElementById('closeDeleteModal').addEventListener('click', function() {
                document.getElementById('deleteModal').classList.add('hidden');
            });
        }
        
        function exportToExcel(reportType = 'all') {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            let dataToExport = [];
            
            if (reportType === 'all') {
                dataToExport = items.map(item => ({
                    'Código': item.code,
                    'Nome': item.name,
                    'Categoria': item.category,
                    'Quantidade': item.quantity,
                    'Status': item.status === 'in-stock' ? 'Em Estoque' : 
                              (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    'Localização': item.location || 'N/A',
                    'Limite Estoque Baixo': item.threshold || 'N/A',
                    'Descrição': item.description || 'N/A'
                }));
            } else if (reportType === 'stock') {
                dataToExport = items.map(item => ({
                    'Código': item.code,
                    'Nome': item.name,
                    'Categoria': item.category,
                    'Quantidade': item.quantity,
                    'Status': item.status === 'in-stock' ? 'Em Estoque' : 
                              (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    'Localização': item.location || 'N/A'
                }));
            } else if (reportType === 'lowStock') {
                const lowStockItems = items.filter(item => item.status === 'low-stock' || item.status === 'out-of-stock');
                dataToExport = lowStockItems.map(item => ({
                    'Código': item.code,
                    'Nome': item.name,
                    'Categoria': item.category,
                    'Quantidade': item.quantity,
                    'Status': item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado',
                    'Limite Estoque Baixo': item.threshold || 'N/A',
                    'Localização': item.location || 'N/A'
                }));
            } else if (reportType === 'category') {
                const categories = [...new Set(items.map(item => item.category))];
                dataToExport = categories.map(category => {
                    const categoryItems = items.filter(item => item.category === category);
                    const totalQuantity = categoryItems.reduce((sum, item) => sum + item.quantity, 0);
                    
                    return {
                        'Categoria': category,
                        'Total de Itens': categoryItems.length,
                        'Quantidade Total': totalQuantity,
                        'Itens em Estoque': categoryItems.filter(item => item.status === 'in-stock').length,
                        'Itens com Estoque Baixo': categoryItems.filter(item => item.status === 'low-stock').length,
                        'Itens Esgotados': categoryItems.filter(item => item.status === 'out-of-stock').length
                    };
                });
            }
            
            if (dataToExport.length === 0) {
                alert('Nenhum dado para exportar');
                return;
            }
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(dataToExport);
            XLSX.utils.book_append_sheet(wb, ws, 'Inventário');
            
            // Generate file and download
            const fileName = reportType === 'all' ? 'inventario_completo.xlsx' : 
                            reportType === 'stock' ? 'relatorio_estoque.xlsx' :
                            reportType === 'lowStock' ? 'itens_baixo_estoque.xlsx' : 'relatorio_categorias.xlsx';
            
            XLSX.writeFile(wb, fileName);
        }
        
        function exportToWord(reportType = 'all') {
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            let dataToExport = [];
            
            if (reportType === 'all') {
                dataToExport = items.map(item => ({
                    code: item.code,
                    name: item.name,
                    category: item.category,
                    quantity: item.quantity,
                    status: item.status === 'in-stock' ? 'Em Estoque' : 
                           (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    location: item.location || 'N/A',
                    threshold: item.threshold || 'N/A',
                    description: item.description || 'N/A'
                }));
            } else if (reportType === 'stock') {
                dataToExport = items.map(item => ({
                    code: item.code,
                    name: item.name,
                    category: item.category,
                    quantity: item.quantity,
                    status: item.status === 'in-stock' ? 'Em Estoque' : 
                           (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    location: item.location || 'N/A'
                }));
            } else if (reportType === 'lowStock') {
                const lowStockItems = items.filter(item => item.status === 'low-stock' || item.status === 'out-of-stock');
                dataToExport = lowStockItems.map(item => ({
                    code: item.code,
                    name: item.name,
                    category: item.category,
                    quantity: item.quantity,
                    status: item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado',
                    threshold: item.threshold || 'N/A',
                    location: item.location || 'N/A'
                }));
            } else if (reportType === 'category') {
                const categories = [...new Set(items.map(item => item.category))];
                dataToExport = categories.map(category => {
                    const categoryItems = items.filter(item => item.category === category);
                    const totalQuantity = categoryItems.reduce((sum, item) => sum + item.quantity, 0);
                    
                    return {
                        category: category,
                        totalItems: categoryItems.length,
                        totalQuantity: totalQuantity,
                        inStock: categoryItems.filter(item => item.status === 'in-stock').length,
                        lowStock: categoryItems.filter(item => item.status === 'low-stock').length,
                        outOfStock: categoryItems.filter(item => item.status === 'out-of-stock').length
                    };
                });
            }
            
            if (dataToExport.length === 0) {
                alert('Nenhum dado para exportar');
                return;
            }
            
            // Create Word document
            const { Document, Paragraph, TextRun, Table, TableRow, TableCell, HeadingLevel, Packer } = docx;
            
            // Create title
            const title = new Paragraph({
                text: reportType === 'all' ? 'Relatório Completo de Inventário' : 
                     reportType === 'stock' ? 'Relatório de Estoque' :
                     reportType === 'lowStock' ? 'Itens com Baixo Estoque' : 'Relatório por Categoria',
                heading: HeadingLevel.HEADING_1,
                spacing: { after: 200 }
            });
            
            // Create table
            const tableRows = [];
            
            // Add header row
            let headers;
            if (reportType === 'all') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Localização', 'Limite Estoque Baixo', 'Descrição'];
            } else if (reportType === 'stock') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Localização'];
            } else if (reportType === 'lowStock') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Limite Estoque Baixo', 'Localização'];
            } else {
                headers = ['Categoria', 'Total de Itens', 'Quantidade Total', 'Itens em Estoque', 'Itens com Estoque Baixo', 'Itens Esgotados'];
            }
            
            const headerCells = headers.map(header => 
                new TableCell({
                    children: [new Paragraph({ text: header, bold: true })],
                    shading: { fill: "DDDDDD" }
                })
            );
            tableRows.push(new TableRow({ children: headerCells }));
            
            // Add data rows
            dataToExport.forEach(item => {
                let cells;
                
                if (reportType === 'all') {
                    cells = [
                        item.code,
                        item.name,
                        item.category,
                        item.quantity.toString(),
                        item.status,
                        item.location,
                        item.threshold.toString(),
                        item.description
                    ];
                } else if (reportType === 'stock') {
                    cells = [
                        item.code,
                        item.name,
                        item.category,
                        item.quantity.toString(),
                        item.status,
                        item.location
                    ];
                } else if (reportType === 'lowStock') {
                    cells = [
                        item.code,
                        item.name,
                        item.category,
                        item.quantity.toString(),
                        item.status,
                        item.threshold.toString(),
                        item.location
                    ];
                } else {
                    cells = [
                        item.category,
                        item.totalItems.toString(),
                        item.totalQuantity.toString(),
                        item.inStock.toString(),
                        item.lowStock.toString(),
                        item.outOfStock.toString()
                    ];
                }
                
                const rowCells = cells.map(cell => 
                    new TableCell({ children: [new Paragraph({ text: cell })] })
                );
                tableRows.push(new TableRow({ children: rowCells }));
            });
            
            const table = new Table({
                rows: tableRows,
                width: { size: 100, type: "PERCENTAGE" }
            });
            
            // Create document
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [title, table]
                }]
            });
            
            // Generate file and download
            const fileName = reportType === 'all' ? 'inventario_completo.docx' : 
                            reportType === 'stock' ? 'relatorio_estoque.docx' :
                            reportType === 'lowStock' ? 'itens_baixo_estoque.docx' : 'relatorio_categorias.docx';
            
            Packer.toBlob(doc).then(blob => {
                saveAs(blob, fileName);
            });
        }
        
        function exportToPdf(reportType = 'all') {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const items = JSON.parse(localStorage.getItem('inventoryItems')) || [];
            let dataToExport = [];
            let headers = [];
            
            if (reportType === 'all') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Localização', 'Limite', 'Descrição'];
                dataToExport = items.map(item => [
                    item.code,
                    item.name,
                    item.category,
                    item.quantity,
                    item.status === 'in-stock' ? 'Em Estoque' : (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    item.location || 'N/A',
                    item.threshold || 'N/A',
                    item.description || 'N/A'
                ]);
            } else if (reportType === 'stock') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Localização'];
                dataToExport = items.map(item => [
                    item.code,
                    item.name,
                    item.category,
                    item.quantity,
                    item.status === 'in-stock' ? 'Em Estoque' : (item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado'),
                    item.location || 'N/A'
                ]);
            } else if (reportType === 'lowStock') {
                headers = ['Código', 'Nome', 'Categoria', 'Quantidade', 'Status', 'Limite', 'Localização'];
                const lowStockItems = items.filter(item => item.status === 'low-stock' || item.status === 'out-of-stock');
                dataToExport = lowStockItems.map(item => [
                    item.code,
                    item.name,
                    item.category,
                    item.quantity,
                    item.status === 'low-stock' ? 'Estoque Baixo' : 'Esgotado',
                    item.threshold || 'N/A',
                    item.location || 'N/A'
                ]);
            } else if (reportType === 'category') {
                headers = ['Categoria', 'Total Itens', 'Quantidade', 'Em Estoque', 'Estoque Baixo', 'Esgotados'];
                const categories = [...new Set(items.map(item => item.category))];
                dataToExport = categories.map(category => {
                    const categoryItems = items.filter(item => item.category === category);
                    const totalQuantity = categoryItems.reduce((sum, item) => sum + item.quantity, 0);
                    
                    return [
                        category,
                        categoryItems.length,
                        totalQuantity,
                        categoryItems.filter(item => item.status === 'in-stock').length,
                        categoryItems.filter(item => item.status === 'low-stock').length,
                        categoryItems.filter(item => item.status === 'out-of-stock').length
                    ];
                });
            }
            
            if (dataToExport.length === 0) {
                alert('Nenhum dado para exportar');
                return;
            }
            
            // Set title
            const title = reportType === 'all' ? 'Relatório Completo de Inventário' : 
                         reportType === 'stock' ? 'Relatório de Estoque' :
                         reportType === 'lowStock' ? 'Itens com Baixo Estoque' : 'Relatório por Categoria';
            
            doc.setFontSize(18);
            doc.text(title, 14, 20);
            doc.setFontSize(12);
            doc.text(`Gerado em: ${new Date().toLocaleDateString()}`, 14, 30);
            
            // Add table
            doc.autoTable({
                head: [headers],
                body: dataToExport,
                startY: 40,
                styles: {
                    fontSize: 8,
                    cellPadding: 2,
                    overflow: 'linebreak'
                },
                headStyles: {
                    fillColor: [41, 128, 185],
                    textColor: 255,
                    fontSize: 9
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245]
                },
                columnStyles: {
                    0: { cellWidth: 'auto' },
                    1: { cellWidth: 'auto' },
                    2: { cellWidth: 'auto' },
                    3: { cellWidth: 'auto' },
                    4: { cellWidth: 'auto' },
                    5: { cellWidth: 'auto' },
                    6: { cellWidth: 'auto' },
                    7: { cellWidth: 'auto' }
                }
            });
            
            // Generate file and download
            const fileName = reportType === 'all' ? 'inventario_completo.pdf' : 
                            reportType === 'stock' ? 'relatorio_estoque.pdf' :
                            reportType === 'lowStock' ? 'itens_baixo_estoque.pdf' : 'relatorio_categorias.pdf';
            
            doc.save(fileName);
        }
    </script>
</body>
</html>
